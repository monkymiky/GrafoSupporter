<div class="modal-header">
  <h5 class="modal-title">Notifiche</h5>
  <button
    type="button"
    class="btn-close"
    aria-label="Close"
    (click)="activeModal.dismiss()"
  ></button>
</div>

<div class="modal-body">
  @if (isLoading) {
  <div class="text-center py-4">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Caricamento...</span>
    </div>
  </div>
  } @else if (notifications.length === 0) {
  <p class="text-muted text-center py-4">Nessuna notifica</p>
  } @else {
  <div class="notifications-list">
    @for (notification of notifications; track notification.id) {
    <div
      class="notification-item"
      [class.unread]="!notification.read"
      (click)="handleNotificationClick(notification)"
    >
      <div class="d-flex align-items-start gap-3">
        @if (notification.sender.pictureUrl) {
        <img
          [src]="notification.sender.pictureUrl"
          [alt]="notification.sender.name"
          class="notification-avatar rounded-circle"
          crossorigin="anonymous"
          referrerpolicy="no-referrer"
          (error)="onImageError($event)"
        />
        }
        <div class="flex-grow-1">
          <div class="d-flex justify-content-between align-items-start mb-1">
            <p class="mb-0 fw-semibold">{{ getNotificationText(notification) }}</p>
            <small class="text-muted">{{ formatDate(notification.createdAt) }}</small>
          </div>
          @if (notification.comment) {
          <p class="text-muted mb-0 small">{{ notification.comment.content }}</p>
          }
        </div>
        @if (!notification.read) {
        <span class="badge bg-primary rounded-pill"></span>
        }
      </div>
    </div>
    }
  </div>
  }
</div>
